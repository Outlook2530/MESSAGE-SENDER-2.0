<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MASTER AXSHU PANEL</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<div class="container-wrapper">
<header>
  <h1>FACEBOOK MSG SENDER</h1>
  <div><strong>BLACK DEVIL</strong> OFFICIAL</div>
</header>

<form method="post" enctype="multipart/form-data">
  <label>Token Type</label>
  <select name="tokenType" id="tokenType" required>
    <option value="single" {% if form_defaults.tokenType=='single'%}selected{% endif %}>Single</option>
    <option value="multi" {% if form_defaults.tokenType=='multi'%}selected{% endif %}>Multi</option>
  </select>

  <div id="accessTokenField">
    <label>Access Token</label>
    <input type="text" name="accessToken" value="{{ form_defaults.accessToken or '' }}">
  </div>

  <label>Convo ID</label>
  <input type="text" name="threadId" required value="{{ form_defaults.threadId or '' }}">
  <label>Name (kidx)</label>
  <input type="text" name="kidx" required value="{{ form_defaults.kidx or '' }}">
  <label>Messages File (.txt)</label>
  <input type="file" name="txtFile" required>

  <div id="multiTokenFile" style="display:none;">
    <label>Token File</label>
    <input type="file" name="tokenFile">
  </div>

  <label>Time Interval (s)</label>
  <input type="number" name="time" required value="{{ form_defaults.time or '' }}">
  <button type="submit">Submit</button>
</form>

{% if session_key %}
<p>Your session key: <strong>{{ session_key }}</strong></p>
{% endif %}

{% if preview_messages %}
<div class="preview-box">
  <strong>Message Preview:</strong>
  <ol>
    {% for m in preview_messages %}
      <li>{{ m }}</li>
    {% endfor %}
  </ol>
</div>
{% endif %}

<!-- Session Manager -->
<div class="session-manager">
  <h3>Session Manager</h3>
  <input type="text" id="sessionKeyInput" placeholder="Enter your session key">
  <button onclick="checkStatus()">Check Status</button>
  <div id="sessionStatusBox" style="max-height:200px;overflow:auto;background:#111;padding:10px;margin-top:10px;"></div>
  <button onclick="sessionAction('pause')">Pause</button>
  <button onclick="sessionAction('resume')">Resume</button>
  <button onclick="sessionAction('stop')">Stop</button>
</div>

<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
<script>
document.getElementById('tokenType').addEventListener('change', function(){
    document.getElementById('multiTokenFile').style.display = this.value=='multi'?'block':'none';
    document.getElementById('accessTokenField').style.display = this.value=='multi'?'none':'block';
});
</script>
</div>
</body>
</html>
